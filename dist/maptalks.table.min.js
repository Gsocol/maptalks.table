/*!
 * maptalks.table v0.1.0
 * LICENSE : MIT
 * (c) 2016-2017 maptalks.org
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("maptalks")):"function"==typeof define&&define.amd?define(["exports","maptalks"],e):e(t.maptalks=t.maptalks||{},t.maptalks$1)}(this,function(t,e){"use strict";function i(t,e){for(var i=Object.getOwnPropertyNames(e),o=0;o<i.length;o++){var a=i[o],r=Object.getOwnPropertyDescriptor(e,a);r&&r.configurable&&void 0===t[a]&&Object.defineProperty(t,a,r)}return t}var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},a=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):i(t,e))},r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},s={title:"title",columns:[{header:"Name",dataIndex:"name",type:"string",maxWidth:50},{header:"Birth",dataIndex:"birth",type:"data",maxWidth:50},{header:"Age",dataIndex:"age",type:"number",maxWidth:50},{header:"Marry",dataIndex:"marry",type:"boolean",trueText:"Yes",falseText:"No",maxWidth:50}],data:[{name:"Tom",birth:"1990-1-1",age:25,marry:"true"},{name:"Peter",birth:"1985-5-1",age:30,marry:"true"},{name:"Mary",birth:"2000-6-1",age:15,marry:"false"}],headerSymbol:{lineColor:"#ffffff",fill:"#4e98dd",textFaceName:"monospace",textSize:12,textFill:"#ebf2f9",textWrapWidth:100},symbol:{lineColor:"#ffffff",fill:"#4e98dd",textFaceName:"monospace",textSize:12,textFill:"#ebf2f9",textWrapWidth:100},position:{x:121.489935,y:31.24432},width:300,height:300,draggable:!0,editable:!0,header:!0,order:!0,startNum:1,dynamic:!1,layerId:null},n={NEED_DATA:"You must set data to Table options.",NEED_COLUMN:"You must set columns to Table options."},h=function(t){function e(i){var a;o(this,e);var s=r(this,t.call(this,i));if(s.options.width=s.options.width||300,s.options.height=s.options.height||300,s.options.header||s.options.header===!1||(s.options.header=!0),s.options.order||s.options.order===!1||(s.options.order=!0),s.options.visible=!0,s.options.editing=!1,s.options.showOrderNumber=!0,s.options.startNum=s.options.startNum||1,!s.options.data&&0===s.options.data.length)throw new Error(n.NEED_DATA);if(!s.options.columns&&0===s.options.columns.length)throw new Error(n.NEED_COLUMN);var h=s.options.orderTitle;if(h||(h="No."),s.options.order){var l=parseInt(s.options.startNum),d={header:h,dataIndex:"maptalks_order",type:"number"};s.options.columns.unshift(d);for(var _=s.options.data,g=0,u=_.length;g<u;g++)_[g].maptalks_order=g+l}return s._initalColumns=s.options.columns,s._headAttributes=s.options.attributes,s._columns=s.getColumns(),s._colNum=s._columns.length,s._data=s.options.data,s._initalData=s._data,s._rowNum=s._data.length,s.options.header&&(s._rowNum+=1),s._cellWidth=s.options.width/s._colNum,s._cellHeight=s.options.height/s._rowNum,s._currentRow=-1,s._currentCol=-1,s._geometryNumLabels=[],s._rowHeights=[],s._colWidths=[],s.tableWidth=0,s.tableHeight=0,s._initRowHeightAndColWidth(),s.tableSymbols=s._initCellSymbol(),a=s,r(s,a)}return a(e,t),e.prototype.toJSON=function(){return{options:this.options,colums:this._columns,attributes:this._headAttributes,colNum:this._colNum,data:this._dataToJSON(),rowNum:this._rowNum,rowHeights:this._rowHeights,colWidths:this._colWidths,tableWidth:this.tableWidth,tableHeight:this.tableHeight,tableSymbols:this.tableSymbols}},e.prototype._dataToJSON=function(){var t=[];if(this.options.dynamic&&this._data&&this._data.length>0)for(var e,i=0,o=this._data.length;i<o;i++)e=this._data[i],t.push(e);else t=this._data;return t},e.prototype.initByJson=function(t){var e=t.options;this._columns=t.colums,this._colNum=t.colNum,this._headAttributes=t.attributes,this._data=[];var i=t.data;if(e.dynamic&&i&&i.length>0)for(var o,a,r,s=0,n=i.length;s<n;s++)o=i[s],a=o.geometry,a&&(r=maptalks.Geometry.fromJSON(a),o.coordinate=r.getCenter(),o.geometry=null,delete o.geometry),this._data.push(o);else this._data=i;return this._rowNum=t.rowNum,this._rowHeights=t.rowHeights,this._colWidths=t.colWidths,this._tableRows=this._data,this.tableSymbols=t.tableSymbols||this._initCellSymbol(),this},e.prototype.getId=function(){return this.options.id},e.prototype.isDynamic=function(){return this.options.dynamic},e.prototype.getLayerId=function(){return this.options.layerId},e.prototype.getType=function(){return"MAPTALKS_TABLE"},e.prototype.getData=function(){for(var t=[],e=0;e<this._data.length;e++)t.push(this._data[e]);return t},e.prototype.getDataByRowNum=function(t){return this.options.header&&(t-=1),this.getData()[t]},e.prototype.getMaxOrder=function(){return this._data.length+this.options.startNum||0},e.prototype.setStartNum=function(t){var e=this.options.startNum||1;this.options.order&&t!==e&&(this.options.startNum=t,this._resetOrderNum(t),this.fire("orderchanged",this))},e.prototype.getTableWidth=function(){return this.tableWidth},e.prototype.getTableHeight=function(){return this.tableHeight},e.prototype.addTo=function(t){t&&(this._layer=t,this._tableRows=this.createTable(),this._addToLayer(this._tableRows,!0),this._addEventsToTable())},e.prototype._addEventsToTable=function(){this.options.editable&&this.on("dblclick",function(t){var e=t.context.cell;e&&this._addEditEventToCell(e)});var t=this,e=this.getMap();this.on("click",function(i){e.options.doubleClickZoom=!1,t.prepareAdjust()})},e.prototype.getLayer=function(){return this._layer},e.prototype.getMap=function(){return this._layer?this._layer.getMap():null},e.prototype.getCenter=function(){return this.getCoordinates()},e.prototype.getCoordinates=function(){var t=this.options.position;return new maptalks.Coordinate(t.x,t.y)},e.prototype.animate=function(t,e,i){var o=this.getAllCells();if(o&&o.length>0)for(var a=0,r=o.length;a<r;a++)o[a].animate(t,e,i)},e.prototype._initRowHeightAndColWidth=function(){if(0===this._rowHeights.length||0===this._colWidths.length){for(var t=0;t<this._colNum;t++)this._colWidths[t]=0;for(var e=0;e<this._rowNum;e++)this._rowHeights[e]=0;this.options.header&&this._calculateHeaderHeight(),this._calculateRowHeight()}for(var i=0;i<this._rowHeights.length;i++)this.tableHeight+=this._rowHeights[i];for(var o=0;o<this._colWidths.length;o++)this.tableWidth+=this._colWidths[o]},e.prototype._calculateHeaderHeight=function(){for(var t=0,e=this._columns.length;t<e;t++){var i=this._columns[t],o=i.header,a=i.maxWidth||this._cellWidth,r=this.getCellSymbol(0,t),s=maptalks.StringUtil.getFont(r),n=maptalks.StringUtil.stringLength(o,s);n.width<=a&&(a=n.width),r.textWrapWidth=a;var h=maptalks.StringUtil.splitTextToRow(o,r),l=h.size;this._colWidths[t]<l.width&&(l.width<=a?this._colWidths[t]=l.width:this._colWidths[t]=a),this._rowHeights[t]<l.height&&(this._rowHeights[0]=l.height)}},e.prototype._calculateRowHeight=function(){var t=0;this.options.header&&(t=1);for(var e=0,i=this._data.length;e<i;e++)for(var o=this._data[e],a=0,r=this._columns.length;a<r;a++){var s=this._columns[a],n=o[s.dataIndex],h=s.maxWidth||this._cellWidth,l=0,d=this.getCellSymbol(e+t,a),_=maptalks.StringUtil.getFont(d),g=maptalks.StringUtil.stringLength(n,_);l=g.width>=h?h:g.width<=this._colWidths[a]?this._colWidths[a]:g.width,d.textWrapWidth=l,this._colWidths[a]=l;var u=maptalks.StringUtil.splitTextToRow(n,d),p=u.size;this._rowHeights[e+t]<p.height&&(this._rowHeights[e+t]=p.height)}},e.prototype._initCellSymbol=function(){for(var t={},e=this.options.headerSymbol||this.options.symbol,i=this.options.symbol,o=0;o<this._rowNum;o++)if(0===o&&this.options.header)for(var a=0;a<this._colNum;a++)e.textWrapWidth=this._colWidths[a],t[o+"_"+a]=e;else for(var r=0;r<this._colNum;r++)i.textWrapWidth=this._colWidths[r],t[o+"_"+r]=i;return t},e.prototype.hide=function(){for(var t,e=0,i=this._tableRows.length;e<i;e++){if(!(t=this._tableRows[e]))return;for(var o=0,a=t.length;o<a;o++)t[o].isEditingText()&&t[o].endEditText(),t[o].hide()}this.fire("hide",this),this.options.visible=!1},e.prototype.show=function(){for(var t,e=0,i=this._tableRows.length;e<i;e++){if(!(t=this._tableRows[e]))return;for(var o=0,a=t.length;o<a;o++)t[o].show()}this.options.visible=!0},e.prototype.isVisible=function(){return this.options.visible},e.prototype.orderNumberIsVisible=function(){return this.options.showOrderNumber},e.prototype.showOrderNumber=function(){this._showNumLabel(),this.options.showOrderNumber=!0},e.prototype.hideOrderNumber=function(){this._hideNumLabel(),this.options.showOrderNumber=!1},e.prototype.getAllCells=function(){for(var t,e=[],i=0,o=this._tableRows.length;i<o;i++)if(t=this._tableRows[i])for(var a=0,r=t.length;a<r;a++)e.push(t[a]);return this.options.dynamic&&this.options.order&&(e=e.concat(this._geometryNumLabels)),e},e.prototype.remove=function(){this.stopEditTable();for(var t,e=0,i=this._tableRows.length;e<i;e++){if(!(t=this._tableRows[e]))return;for(var o=0,a=t.length;o<a;o++)t[o].remove()}this._tableRows=[],this.fire("remove",this),this._deleteTable()},e.prototype.setZIndex=function(t){this._zindex=t;for(var e=0;e<this._rowNum;e++){var i=this._tableRows[e];if(!i)return;for(var o=0,a=i.length;o<a;o++)i[o].setZIndex(t)}},e.prototype.getZIndex=function(){return this._zindex},e.prototype.bringToFront=function(){for(var t=0;t<this._rowNum;t++){var e=this._tableRows[t];if(!e)return;for(var i=0,o=e.length;i<o;i++)e[i].bringToFront()}},e.prototype.bringToBack=function(){for(var t=0;t<this._rowNum;t++){var e=this._tableRows[t];if(!e)return;for(var i=0,o=e.length;i<o;i++)e[i].bringToBack()}},e.prototype.stopEditTable=function(){for(var t,e=0,i=this._tableRows.length;e<i;e++){if(!(t=this._tableRows[e]))return;for(var o=0,a=t.length;o<a;o++)t[o].isEditingText()&&t[o].endEditText()}},e.prototype.isEditing=function(){return this.options.editing},e.prototype._deleteTable=function(){delete this._initalColumns,delete this._headAttributes,delete this._columns,delete this._colNum,delete this._data,delete this._initalData,delete this._rowNum,delete this.tableWidth,delete this.tableHeight,delete this._cellWidth,delete this._cellHeight,delete this._currentRow,delete this._currentCol,delete this._rowHeights,delete this._colWidths,delete this.options,delete this._tableRows,delete this._layer,delete this},e.prototype.refreshData=function(t,e){for(var i=this.getData(),o=this._getUpdateItems(i,t,e),a=this._getMinusItems(i,t,e),r=this._getMinusItems(t,i,e),s=0;s<o.length;s++)this.updateRow(o[s].maptalks_order,o[s]);for(var n=a.length-1;n>=0;n--)this.removeRow(a[n].maptalks_order);var h=0;this.options.header&&(h=1);for(var l=this.getData().length-1,d=0;d<r.length;d++)this.addRow(l+d+h,r[d],!0)},e.prototype._uniquelize=function(t,e){if(!e)return[];for(var i=[],o=0;o<t.length;o++){for(var a=!0,r=0;r<i.length;r++)if(t[o][e]===i[r][e]){a=!1;break}a&&i.push(t[o])}return i},e.prototype._getUpdateItems=function(t,e,i){if(!i)return[];var o=[];t=this._uniquelize(t,i);for(var a=0;a<t.length;a++)for(var r=0;r<e.length;r++)if(e[r][i]===t[a][i]){e[r].maptalks_order=t[a].maptalks_order,o.push(e[r]);break}return o},e.prototype._getMinusItems=function(t,e,i){if(!i)return[];var o=[];t=this._uniquelize(t,i);for(var a=0;a<t.length;a++){for(var r=!0,s=0;s<e.length;s++)e[s][i]===t[a][i]&&(r=!1);r&&o.push(t[a])}return o},e.prototype.setCoordinates=function(t){var e=new maptalks.Coordinate(t.x,t.y),i=e.substract(this.getCenter());this._translate(i)},e.prototype._addToLayer=function(t,e){for(var i=void 0,o=void 0,a=0,r=t.length;a<r;a++){if(!(i=t[a]))return;for(var s=0,n=i.length;s<n;s++)o=i[s],e&&(o._row=a,o._col=s),this._addEventsToCell(o).addTo(this._layer)}},e.prototype._showHeaderItemMenu=function(t,e){for(var i=[],o=void 0,a=void 0,r=void 0,s=this,n=0,h=this._headAttributes.length;n<h;n++)o=this._headAttributes[n],a=o.displayName,r={item:a,click:function(e){s._changeHeader(e,t)}},i.push(r);var l={width:160,maxHeight:300,items:i};this.getMap().setMenu(l).openMenu(e)},e.prototype._changeHeader=function(t,e){var i=t.index,o=this._headAttributes[i];e.dataIndex=o.name,e.setContent(o.displayName),this._setColData(e);var a=e._col;this._columns[a]={header:o.displayName,dataIndex:o.name,type:"string"}},e.prototype._setColData=function(t){for(var e=t.dataIndex,i=t._col,o=[],a=void 0,r=0,s=this._initalData.length;r<s;r++)a=this._initalData[r],o[r+1]=a[e];for(var n=void 0,h=1,l=this._tableRows.length;h<l;h++){if(!(n=this._tableRows[h]))return;t=n[i],t.setContent(o[h])}},e.prototype._dragTableStart=function(){this.fire("dragstart",{target:this})},e.prototype._dragTableEnd=function(){this.fire("dragend",{target:this})},e.prototype._dragTable=function(){var t=event.dragOffset;this._translate(t),this.fire("moving dragging",{target:this})},e.prototype._translate=function(t){for(var e=void 0,i=void 0,o=0,a=this._tableRows.length;o<a;o++){if(!(e=this._tableRows[o]))return;for(var r=0,s=e.length;r<s;r++)i=e[r],i.translate(t),0===o&&0===r&&(this.options.position=i.getCenter())}},e.prototype._addMouseoverEvent=function(t){t.context=this,this.table.fire("mouseover",t)},e.prototype._addMouseoutEvent=function(t){t.context=this,this.table.fire("mouseout",t)},e.prototype._addMousedownEvent=function(t){t.context=this,this.table.fire("mousedown",t)},e.prototype._addClickEvent=function(t){t.context=this,this.table.fire("click",t)},e.prototype._addDBLClickEvent=function(t){t.context=this,this.table.fire("dblclick",t)},e.prototype._addContextmenuEvent=function(t){t.context=this,this.table.fire("contextmenu",t)},e.prototype._addEditTableEvent=function(t){t.context=this,this.table.fire("edittablestart",t),this.table.options.editing=!0},e.prototype.createTable=function(){for(var t,e=[],i=0;i<this._rowNum;i++)0===i&&this.options.header?e.push(this.createHeader()):(t=this._data[i],this._data&&this._data.length>0&&(this.options.header&&(t=this._data[i-1]),t&&e.push(this._createRow(i,t))));return e},e.prototype.getColumns=function(){var t=this.options.columns;if(!t){t=[];var e=this.options.data,i=void 0,o=void 0;for(var a in e)i=this._getDataType(e[a]),o={header:a,dataIndex:a,type:i},t.push(o)}return t},e.prototype._getDataType=function(t){var e="string";return maptalks.isNumber(t)&&(e="number"),e},e.prototype.setTableStyle=function(t,e,i){if(i){for(var o=0;o<this._rowNum;o++)this._setRowStyle(o,t,e);this._changeDefaultSymbol(t,e)}else{var a=this._currentRow,r=this._currentCol;a>-1&&this._setRowStyle(a,t,e),r>-1&&this._setColStyle(r,t,e)}},e.prototype._setRowStyle=function(t,e,i){for(var o=this._tableRows[t],a=0,r=o.length;a<r;a++){var s=o[a],n=s.getSymbol(),h=i;"textFont"===e&&(h=i+" "+n.textSize+"px "+n.textFaceName),this._setStyleToCell(s,e,h)}},e.prototype._setColStyle=function(t,e,i){for(var o=0,a=this._tableRows.length;o<a;o++){var r=this._tableRows[o],s=r[t],n=s.getSymbol(),h=i;"textFont"===e&&(h=i+" "+n.textSize+"px "+n.textFaceName),this._setStyleToCell(s,e,h)}},e.prototype._setStyleToCell=function(t,e,i){var o=t.getSymbol();"textAlign"===e?(o.textHorizontalAlignment=i,"left"===i?o.textDx-=t.getSize.width/2:"right"===i&&(o.textDx+=t.getSize.width/2),t.setSymbol(o)):(o[e]=i,t.setSymbol(o))},e.prototype._changeDefaultSymbol=function(t,e){var i=this.options.symbol;"textAlign"===t?i.textHorizontalAlignment=e:"textFont"===t?e=e+" "+i.textSize+"px "+i.textFaceName:"markerFill"===t?i.fill=e:"markerLineColor"===t&&(i.lineColor=e),i[t]=e,this.options.symbol=i},e}(maptalks.JSONAble(maptalks.Eventable(maptalks.Handlerable(maptalks.Class))));h.mergeOptions(s),h.registerJSONType("Table"),h.include({createCell:function(t,e,i,o){var a=o.textSize||12,r=o.textLineSpacing||8;t=this._filterContent(t);var s={symbol:{markerLineColor:o.lineColor||"#ffffff",markerLineWidth:1,markerLineOpacity:.9,markerLineDasharray:null,markerFill:o.fill||"#4e98dd",markerFillOpacity:.9,markerDx:e.dx||0,markerDy:e.dy||0,textFaceName:o.textFaceName||"microsoft yahei",textSize:a,textFill:o.textFill||"#ff0000",textOpacity:1,textSpacing:30,textWrapWidth:i.width,textWrapBefore:!1,textLineSpacing:r,textHorizontalAlignment:o.textHorizontalAlignment||"middle",textVerticalAlignment:o.textVerticalAlignment||"middle",textWeight:o.textWeight,textStyle:o.textStyle,textDx:e.dx||0,textDy:e.dy||0},boxPadding:{width:15,height:8},draggable:!1,boxAutoSize:!1,boxMinWidth:i.width,boxMinHeight:i.height},n=this.options.position;return new maptalks.TextBox(t,n,s)},getCellOffset:function(t,e){var i=0,o=0,a=this._cellWidth/2,r=this._cellHeight/2;this._rowHeights[t]&&(a=this._rowHeights[t]/2),this._colWidths[e]&&(r=this._colWidths[e]/2);for(var s=0;s<t;s++)o+=this._rowHeights[s];o+=a;for(var n=0;n<e;n++)i+=this._colWidths[n];return i+=r,{dx:i,dy:o}},getCellSymbol:function(t,e){var i=this.options.symbol;if(this.tableSymbols){var o=this.tableSymbols[t+"_"+e];if(o)return o.textLineSpacing||(o.textLineSpacing=i.textLineSpacing),o}return i},getRowNum:function(t){return t._row},getColNum:function(t){return t._col},_addEventsToCell:function(t){var e={table:this,cell:t,row:t._row,col:t._col,dataIndex:t.dataIndex};return t.on("mouseover",this._addMouseoverEvent,e).on("mouseout",this._addMouseoutEvent,e).on("mousedown",this._addMousedownEvent,e).on("click",this._addClickEvent,e).on("dblclick",this._addDBLClickEvent,e).on("contextmenu",this._addContextmenuEvent,e).on("symbolchange",this._cellSymbolChangeEvent,e).on("edittextstart",this._addEditTableEvent,e).on("edittextend",this._cellEditTextEnd,e),t},_cellSymbolChangeEvent:function(t){t.context=this;var e=this.table,i=this.cell;e.fire("symbolchange",t);var o=this.cell.getSymbol();e.tableSymbols[i._row+"_"+i._col]=e.convertCellToSaveSymbol(o)},_cellEditTextEnd:function(t){t.context=this;var e=this.table,i=this.cell,o=i._row,a=i._col,r=e._columns[a],s=r.dataIndex;e.options.header?o>0?(o-=1,e._data[o][s]=i.getContent()):e._columns[a].header=i.getContent():e._data[o][s]=i.getContent(),this.table.fire("edittableend",t),this.table.options.editing=!1},convertCellToSaveSymbol:function(t){return{fill:t.markerFill,lineColor:t.markerLineColor,textFaceName:t.textFaceName,textFill:t.textFill,textSize:t.textSize,textWrapWidth:t.textWrapWidth,textHorizontalAlignment:t.textHorizontalAlignment,textWeight:t.textWeight,textStyle:t.textStyle}},removeNumLabelByRowNum:function(t){for(var e=this._geometryNumLabels.length-1;e>=t-1;e--)this._geometryNumLabels[e].remove(),this._geometryNumLabels.splice(e,1)},_addEditEventToCell:function(t){t.startEditText();var e=t._textEditor;e.focus();var i=e.value;e.value="","\u7a7a"!==i&&(e.value=i);var o=this;t.on("remove",function(){t.isEditingText()&&t.endEditText()}),t.on("edittextend",function(){var e=t.getContent(),i=t._row,a=t._col,r=o._columns[a].dataIndex;o.options.header&&i>0?o._data[i-1][r]=e:o._columns[a].header=e})},_addNumberLabelToGeometry:function(t,e){var i=this,o=e.getSymbol(),a=this.getId()+"_"+this.getRowNum(e),r={id:a,symbol:this._convertCellSymbolToNumberSymbol(o),draggable:!1,boxAutoSize:!1,boxMinWidth:20,boxMinHeight:20},s=e.getContent(),n=this.getLayer().getGeometryById(a);n||(n=new maptalks.Label(s,t,r),this.getLayer().addGeometry(n)),this._geometryNumLabels.push(n);var h=this;e.on("remove",function(){h._removeNumLabel(n),n.remove()},this),e.on("hide",function(){n.hide()},this),e.on("show",function(){n.show()},this),e.on("contentchange",function(){var t=0;i.options.header&&(t=-1);var o=e._row+t,a=i._data[o],r=a.coordinate;r&&n.setCoordinates(new maptalks.Coordinate(r.x,r.y))},this),e.on("symbolchange",function(){var t=i._convertCellSymbolToNumberSymbol(e.getSymbol());i._changeNumLabelSymbol(n,t),n.setSymbol(t)},this),e.on("contentchange positionchanged",function(){var t=e.getContent();i._changeNumLabelContent(n,t),n.setContent(t)},this)},_hideNumLabel:function(){for(var t=0;t<this._geometryNumLabels.length;t++)this._geometryNumLabels[t].hide()},_showNumLabel:function(){for(var t=0;t<this._geometryNumLabels.length;t++)this._geometryNumLabels[t].show()},_removeNumLabel:function(t){for(var e=0;e<this._geometryNumLabels.length;e++)if(t===this._geometryNumLabels[e]){this._geometryNumLabels.splice(e,1);break}},_changeNumLabelSymbol:function(t,e){for(var i=0;i<this._geometryNumLabels.length;i++)if(t===this._geometryNumLabels[i]){this._geometryNumLabels[i].setSymbol(e);break}},_changeNumLabelContent:function(t,e){for(var i=0;i<this._geometryNumLabels.length;i++)if(t===this._geometryNumLabels[i]){this._geometryNumLabels[i].setContent(e);break}},_convertCellSymbolToNumberSymbol:function(t){return{markerType:"ellipse",markerLineColor:"#ffffff",markerLineWidth:0,markerLineOpacity:t.markerLineOpacity||0,markerFill:t.markerFill||"#4e98dd",markerFillOpacity:t.markerFillOpacity||1,markerDx:0,markerDy:0,markerHeight:30,markerWidth:30,textFaceName:t.textFaceName||"microsoft yahei",textSize:t.textSize||12,textFill:t.textFill||"#ff0000",textOpacity:t.textOpacity||1,textSpacing:t.textSpacing||0,textWrapBefore:!1,textLineSpacing:t.textLineSpacing||0,textHorizontalAlignment:t.textHorizontalAlignment||"middle",textVerticalAlignment:t.textVerticalAlignment||"middle",textDx:0,textDy:0}},_filterContent:function(t){return t+="",t.replace(/\r/gi,"").replace(/\v/gi,"").replace(/\f/gi,"").replace(/\t/gi,"").replace(/\b/gi,"").replace(/\n\n/gi,"\n")},isNumber:function(t){return"number"==typeof t&&!isNaN(t)}}),h.include({addCol:function(t,e,i){var o=t+1;return i||(o=t),this._createCol(o,e,!0),this},removeCol:function(t){this.stopEditTable();for(var e=this._tableRows[0],i=e[t],o=i.getSize(),a=this.options.position,r=this._layer.getMap(),s=void 0,n=void 0,h=void 0,l=void 0,d=void 0,_=void 0,g=void 0,u=void 0,p=0,c=this._tableRows.length;p<c;p++){if(!(s=this._tableRows[p]))return;for(var m=t,f=s.length;m<f;m++)n=s[m],0===p&&m===t&&(this.tableWidth-=o.width),m>t?(this._translateDx(n,1-o.width),0===p&&this._adjustCols&&(h=this._adjustCols[n._col],l=n.getSize(),d=n.getSymbol(),_=d.textDx,g=r.locate(a,r.pixelToDistance(l.width/2+_,0),r.pixelToDistance(0,l.height/2)),u=r.locate(g,0,-r.pixelToDistance(0,this.tableHeight)),h.setCoordinates([g,u])),n._col-=1):n.remove();this._tableRows[p].splice(t,1),this.options.header?p>0&&delete this._data[p-1][i.dataIndex]:delete this._data[p][i.dataIndex]}this._colWidths.splice(t,1),this._columns.splice(t,1),this._colNum-=1},moveCol:function(t,e){this.stopEditTable();var i=t;"left"===e?t>0&&(i=t-1):"right"===e&&t<this._colNum-1&&(i=t+1),this._changeColOrder(t,i)},getColumnNum:function(){return this._colNum},getColumn:function(t){for(var e=[],i=0;i<this._rowNum;i++)e.push(this._tableRows[i][t]);return e},getColumnWidth:function(t){return this._colWidths[t]},setColumnWidth:function(t,e){var i=this.getColumnWidth(t),o=e-i;this.setColumnOffset(t,o)},setColumnOffset:function(t,e){this._colWidths[t]+=e;for(var i=this._colWidths[t],o=void 0,a=void 0,r=void 0,s=0,n=this._tableRows.length;s<n;s++){if(!(o=this._tableRows[s]))return;for(var h=t,l=o.length;h<l;h++)a=o[h],r=a.getSymbol(),h===t?(a.options.boxMinWidth=i,r.markerWidth=a.options.boxMinWidth,r.textWrapWidth=a.options.boxMinWidth,r.markerDx+=e/2,r.textDx+=e/2):(r.markerDx+=e,r.textDx+=e),a.setSymbol(r)}this.tableWidth+=e,this.fire("widthchanged",this)},_createCol:function(t,e,i){var o=t;e&&0!==e.length||(e="");var a=[],r=1,s=void 0;if(maptalks.Util.isArrayHasData(e[0])){r=e.length,s=[];for(var n=0,h=e.length;n<h;n++)for(var l=0;l<this._rowNum;l++){var d=this._addCellForColumn(e[n][0],e[n][l],l,t+n,i);this._tableRows[l].splice(t+n,0,d)}a.push(s)}else for(var _=0;_<this._rowNum;_++){var g=this._addCellForColumn(e[0],e[_],_,t,i);this._tableRows[_].splice(t,0,g)}this._colNum+=r,this._adjustDatasetForCol(o,r)},_addCellForColumn:function(t,e,i,o,a){var r=void 0,s=void 0,n=void 0,h=void 0,l=void 0;if(a){var d=o-1,_=this.getCellOffset(i,d),g=this._colWidths[d];r=0===i?{dx:_.dx+(g+this._cellWidth)/2,dy:_.dy}:this.getCellOffset(i,o),s=this.options.symbol,this.options.header&&0===i&&(s=this.options.headerSymbol),h=this._cellWidth,n=new maptalks.Size(this._cellWidth,this._rowHeights[i])}else r=this.getCellOffset(i,o),s=this.getCellSymbol(i,o),h=this._colWidths[o],n=new maptalks.Size(h,this._rowHeights[i]);if(0===i){var u={header:t,dataIndex:t,type:"string"};this._columns.splice(o,0,u),l=this.createCell(t,r,n,s),this.tableWidth+=h,this._colWidths.splice(o,0,h)}else l=this.createCell(e,r,n,s),this.options.header&&--i,this._data[i][t]=e;return l._row=i,l._col=o,l.dataIndex=t,this.tableSymbols[i+"_"+o]=s,this._addEventsToCell(l).addTo(this._layer),l},_changeColOrder:function(t,e){if(t!==e){var i=this._tableRows[0],o=i[t],a=o._row,r=o._col,s=this._colWidths[t],n=this.getCellOffset(a,r).dx,h=i[e],l=h._row,d=h._col,_=this._colWidths[e],g=this.getCellOffset(l,d).dx;n<g?(n+=_,g-=s):(n-=_,g+=s);for(var u=void 0,p=void 0,c=void 0,m=void 0,f=0,v=this._tableRows.length;f<v;f++){if(!(u=this._tableRows[f]))return;p=u[t].getSymbol(),p.markerDx=n,p.textDx=n,u[t].setSymbol(p),u[t]._col=e,c=u[e].getSymbol(),c.markerDx=g,c.textDx=g,u[e].setSymbol(c),u[e]._col=t,m=u[t],u[t]=u[e],u[e]=m}this._colWidths[t]=this._colWidths[e],this._colWidths[e]=s;var b=this._columns[t];this._columns[t]=this._columns[e],this._columns[e]=b}},_adjustDatasetForCol:function(t,e){for(var i=this.options.position,o=this._layer.getMap(),a=void 0,r=void 0,s=void 0,n=void 0,h=void 0,l=void 0,d=void 0,_=void 0,g=0,u=this._tableRows.length;g<u;g++){if(!(a=this._tableRows[g]))return;for(var p=t+1,c=a.length;p<c;p++)r=a[p],r._col+=e,r.fire("symbolchange",r),this._translateDx(r,this._cellWidth),0===g&&this._adjustCols&&(s=this._adjustCols[p],n=r.getSize(),h=r.getSymbol(),l=h.textDx,d=o.locate(i,o.pixelToDistance(n.width/2+l,0),o.pixelToDistance(0,n.height/2)),_=o.locate(d,0,-o.pixelToDistance(0,this.tableHeight)),s.setCoordinates([d,_]))}},_translateDx:function(t,e){var i=t.getSymbol();i.markerDx+=e,i.textDx+=e,t.setSymbol(i)}});var l=maptalks.INTERNAL_LAYER_PREFIX+"_drag_stage",d=maptalks.Browser.touch?"touchstart mousedown":"mousedown",_=function(t){function e(i){return o(this,e),r(this,t.call(this,i))}return a(e,t),e.prototype.addHooks=function(){this.target.on(d,this._startDrag,this)},e.prototype.removeHooks=function(){this.target.off(d,this._startDrag,this)},e.prototype._startDrag=function(t){if(this.target.getMap()&&!this._isDragging){var e=t.domEvent;e.touches&&e.touches.length>1||(this.target.on("click",this._endDrag,this),this._lastPos=t.coordinate,this._prepareMap(),this._prepareDragHandler(),this._dragHandler.onMouseDown(t.domEvent),this._moved=!1,this.target.fire("dragstart",t))}},e.prototype._prepareMap=function(){var t=this.target.getMap();this._mapDraggable=t.options.draggable,this._mapHitDetect=t.options.hitDetect,t._trySetCursor("move"),t.config({hitDetect:!1,draggable:!1})},e.prototype._prepareDragHandler=function(){var t=this.target.getMap();this._dragHandler=new maptalks.DragHandler(t._panels.mapWrapper||t._containerDOM),this._dragHandler.on("dragging",this._dragging,this),this._dragHandler.on("mouseup",this._endDrag,this),this._dragHandler.enable()},e.prototype._prepareShadow=function(){var t=this.target;this._prepareDragStageLayer(),this._shadow&&this._shadow.remove();var e=t.tableWidth,i=t.tableHeight;this._shadow=new maptalks.Marker(t.getCenter(),{draggable:!0,symbol:{markerType:"square",markerLineColor:"#ffffff",markerLineDasharray:[5,5,2,5],markerFill:"#4e98dd",markerFillOpacity:.2,markerWidth:e,markerHeight:i,markerDx:e/2,markerDy:i/2}});var o=this._shadow;if(t.options.dragShadow){var a=maptalks.Util.decreaseSymbolOpacity(o._getInternalSymbol(),.5);o.setSymbol(a)}o.setId(null);var r=[];this._shadowConnectors=r,this._dragStageLayer.bringToFront().addGeometry(r.concat(o))},e.prototype._onTargetUpdated=function(){this._shadow&&this._shadow.setSymbol(this.target.getSymbol())},e.prototype._prepareDragStageLayer=function(){var t=this.target.getMap(),e=this.target.getLayer();this._dragStageLayer=t.getLayer(l),this._dragStageLayer||(this._dragStageLayer=new maptalks.VectorLayer(l,{drawImmediate:!0}),t.addLayer(this._dragStageLayer)),this._dragStageLayer._getRenderer()._resources=e._getRenderer()._resources},e.prototype._dragging=function(t){var e=this.target,i=e.getMap(),o=i._parseEvent(t.domEvent),a=o.domEvent;if(!(a.touches&&a.touches.length>1)){if(!this._moved)return this._moved=!0,e.on("symbolchange",this._onTargetUpdated,this),this._prepareMap(),this._isDragging=!0,this._prepareShadow(),void this._shadow._fireEvent("dragstart",o);if(this._shadow){var r=o.coordinate;this._lastPos||(this._lastPos=r);var s=r.substract(this._lastPos),n=this._shadow.options.dragOnAxis;"x"===n?s.y=0:"y"===n&&(s.x=0),this._lastPos=r,this._shadow.translate(s),o.dragOffset=s,this._shadow._fireEvent("dragging",o),e.fire("dragging",o)}}},e.prototype._endDrag=function(t){var e=this.target,i=e.getMap();if(this._dragHandler&&(e.off("click",this._endDrag,this),this._dragHandler.disable(),delete this._dragHandler),i){var o;i&&(o=i._parseEvent(t.domEvent)),e.off("symbolchange",this._onTargetUpdated,this);var a=this._shadow;a&&(e.setCoordinates(a.getCoordinates()),a._fireEvent("dragend",o),a.remove(),delete this._shadow),this._shadowConnectors&&(i.getLayer(l).removeGeometry(this._shadowConnectors),delete this._shadowConnectors),delete this._lastPos,i._trySetCursor("default"),maptalks.Util.isNil(this._mapDraggable)&&(this._mapDraggable=!0),i.config({hitDetect:this._mapHitDetect,draggable:!0}),delete this._autoBorderPanning,delete this._mapDraggable,this._isDragging=!1,e.fire("dragend",o)}},e}(maptalks.Handler);h.addInitHook("addHandler","draggable",_),h.include({isDragging:function(){return!!this._isDragging}}),h.include({createHeader:function(){for(var t=[],e=void 0,i=void 0,o=void 0,a=void 0,r=void 0,s=0,n=this._columns.length;s<n;s++){e=this.getCellOffset(0,s),i=this._columns[s],o=i.header,a=new maptalks.Size(this._colWidths[s],this._rowHeights[0]);var h=this.getCellSymbol(0,s);r=this.createCell(o,e,a,h),r._row=0,r._col=s,r.dataIndex=i.dataIndex,t.push(r)}return t}}),h.include({addRow:function(t,e,i){var o=t;i&&(o=t+1);var a=[],r=0;if(e&&0!==e.length)if(maptalks.Util.isArrayHasData(e))for(var s=void 0,n=0,h=e.length;n<h;n++)s=e[n],a.push(this._createRow(o,s,!0)),r+=this._rowHeights[o],o+=1;else{var l=this._createRow(o,e,!0);a.push(l),r+=this._rowHeights[o]}else a.push(this._createRow(o,e,!0));this._addToLayer(a);var d=this._tableRows.slice(0,o),_=this._tableRows.slice(o);return this._adjustDatasetForRow(a.length,_,r),this._tableRows=d.concat(a).concat(_),this._rowNum+=a.length,this.fire("addrow",this),this.fire("orderchanged",this),this},moveRow:function(t,e){this.stopEditTable();var i=t;"up"===e?t>0&&(i=t-1):"down"===e&&t<this._rowNum-1&&(i=t+1),this._changeRowOrder(t,i)},updateRow:function(t,e){t-=parseInt(this.options.startNum||1);var i=t;this.options.header&&(i=t+1);var o=this._tableRows[i];if(o){this._data[t]=e;for(var a=void 0,r=void 0,s=0;s<this._colNum;s++){a=this._columns[s].dataIndex,r="",e&&e[a]&&(r=e[a]);var n=o[s];n&&(this.options.order&&"maptalks_order"===a&&(r=n.getContent()),n.setContent(r))}}},removeRow:function t(e){this.stopEditTable();for(var t=this._tableRows[e],i=t[0],o=i.getSize(),a=void 0,r=void 0,s=e,n=this._tableRows.length;s<n;s++){if(!(a=this._tableRows[s]))return;for(var h=0,l=a.length;h<l;h++)if(r=a[h],s>e){if(r._row-=1,this.options.order&&"maptalks_order"===this._columns[h].dataIndex){var d=this.options.startNum||1;d>1?r.setContent(r._row+d):r.setContent(r._row)}this._translateDy(r,1-o.height)}else r.remove()}this.tableHeight-=o.height+1,this._tableRows.splice(e,1),this._rowHeights.splice(e,1);var _=0;this.options.header?(this._data.splice(e-1,1),_=e-1):(this._data.splice(e,1),_=e),this.removeNumLabelByRowNum(e);for(var g=_;g<this._data.length;g++)this._data[g].maptalks_order-=1;this._rowNum-=1,this.fire("removerow",this),this.fire("orderchanged",this)},getRowsNum:function(){return this._rowNum},getRow:function(t){return this._tableRows[t]},getRowHeight:function(t){return this._rowHeights[t]},setRowHeight:function(t,e){var i=this.getRowHeight(t),o=e-i
;this.setRowOffset(t,o)},setRowOffset:function(t,e){this._rowHeights[t]+=e;for(var i=this._rowHeights[t],o=void 0,a=void 0,r=void 0,s=t;s<this._rowNum;s++){o=this._tableRows[s];for(var n=0;n<this._colNum;n++)a=o[n],r=a.getSymbol(),s===t?(a.options.boxMinHeight=i,a.options.boxMinHeight<r.markerHeight&&(r.markerHeight=a.options.boxMinHeight),r.textWrapWidth=i,r.markerDy+=e/2,r.textDy+=e/2):(r.markerDy+=e,r.textDy+=e),a.setSymbol(r),this.tableSymbols[s+"_"+n]=r}this.tableHeight+=e,this.fire("heightchanged",this)},_createRow:function(t,e,i){var o=[],a=void 0,r=void 0,s=void 0,n=void 0,h=void 0,l=void 0,d=void 0,_=void 0,g=this._rowHeights[t];g||(g=this._cellHeight);for(var u=0;u<this._colNum;u++){if(a=this._columns[u],r=a.dataIndex,s="",e?e[r]&&(s=e[r]):e={},this.options.order&&"maptalks_order"===r){if(!s||""===s){var p=this.options.startNum||1;s=p>1?t+p-1:t}e[r]=s}if(i){var c=this.getCellOffset(t-1,u);n={dx:c.dx,dy:c.dy+g},_=this.options.symbol,h=new maptalks.Size(this._colWidths[u],g)}else n=this.getCellOffset(t,u),_=this.getCellSymbol(t,u),h=new maptalks.Size(this._colWidths[u],g);l=this.createCell(s,n,h,_),l._row=t,l._col=u,l.dataIndex=r,o[u]=l,this.tableSymbols[t+"_"+u]=_,this.options.dynamic&&this.options.order&&"maptalks_order"===r&&(d=e.coordinate)&&this._addNumberLabelToGeometry(new maptalks.Coordinate(d.x,d.y),l)}return i&&(this._rowHeights.splice(t,0,g),this.options.header&&--t,this._data.splice(t,0,e),this.tableHeight+=g),o},_changeRowOrder:function(t,e){if(t!==e){var i=0;if(this.options.header&&(i=-1),0!==e){var o=this._tableRows[t],a=this._tableRows[e],r=o[0],s=r._row,n=r._col,h=this._rowHeights[s],l=this.getCellOffset(s,n).dy,d=a[0],_=d._row,g=d._col,u=this._rowHeights[_],p=this.getCellOffset(_,g).dy;l<p?(l+=u,p-=h):(l-=u,p+=h);for(var c=0,m=o.length;c<m;c++){var f=o[c].getSymbol();o[c]._row=e,f.markerDy=l,f.textDy=l,o[c].setSymbol(f),this.options.order&&"maptalks_order"===this._columns[c].dataIndex&&(o[c].setContent(e),this._data[t+i].maptalks_order=e,o[c].fire("positionchanged",{target:o[c]}))}for(var v=0,b=a.length;v<b;v++){var y=a[v].getSymbol();a[v]._row=t,y.markerDy=p,y.textDy=p,a[v].setSymbol(y),this.options.order&&"maptalks_order"===this._columns[v].dataIndex&&(a[v].setContent(t),this._data[e+i].maptalks_order=t,a[v].fire("positionchanged",{target:a[v]}))}this._tableRows[e]=o,this._tableRows[t]=a;var w=this._data[t+i];this._data[t+i]=this._data[e+i],this._data[e+i]=w,this._rowHeights[t]=this._rowHeights[e],this._rowHeights[e]=h}}},_adjustDatasetForRow:function(t,e,i){var o=void 0,a=0;this.options.header&&(a=-1);for(var r=0,s=e.length;r<s;r++){o=e[r];for(var n=0,h=o.length;n<h;n++){if(o[n]._row+=t,this.options.order&&"maptalks_order"===this._columns[n].dataIndex){var l=o[n]._row,d=this.options.startNum||1;d>1&&(l+=d),o[n].setContent(l),this._data[o[n]._row+a].maptalks_order=l}o[n].fire("symbolchange",o[n]),this._translateDy(o[n],i)}}return this},_resetOrderNum:function(t){if(this.options.order){var e=0;this.options.header&&(e=-1);var i=0;this.options.header&&(i=1);for(var o=i,a=this._tableRows.length;o<a;o++)for(var r=this._tableRows[o],s=0;s<r.length;s++)if("maptalks_order"===r[s].dataIndex){var n=o+t+e;r[s].setContent(n),r[s].fire("positionchanged",{target:r[s]}),this._data[o+e].maptalks_order=n;break}}},_translateDy:function(t,e){var i=t.getSymbol();i.markerDy+=e,i.textDy+=e,t.setSymbol(i)}});var g=maptalks.INTERNAL_LAYER_PREFIX+"_table_adjust_layer_";h.include({prepareAdjust:function(){this.getMap()&&this.options.header&&(this._adjustLaye&&!maptalks.Util.isArrayHasData(this._adjustLayer.getGeometries())||this._prepareEditLayer())},_prepareEditLayer:function(){var t=this.getMap(),e=this.getCoordinates(),i=t.coordinateToViewPoint(e),o=maptalks.Util.UID(),a=g+o;this._adjustLayer=t.getLayer(a),this._adjustLayer||(this._adjustLayer=new maptalks.VectorLayer(a),t.addLayer(this._adjustLayer)),this._topLines=this._createTopHandleLine(i),this._leftLines=this._createLeftHandleLine(i),this._bindTableEvent()},_createTopHandleLine:function(t){for(var e=this,i=this.getMap(),o=this._rowHeights[0],a=[],r=0,s=0;s<this.getColumnNum();s++)!function(s){var n=i.viewPointToCoordinate(t.add(new maptalks.Point(r+10,0)));r+=e.getColumnWidth(s);var h=i.viewPointToCoordinate(t.add(new maptalks.Point(r,0))),l=i.viewPointToCoordinate(t.add(new maptalks.Point(r,o))),d=new maptalks.LineString([h,l],{id:"__table_top_adjust_line_id_"+s,draggable:!0,dragShadow:!1,dragOnAxis:"x",cursor:"ew-resize",symbol:{lineColor:"#ffffff",lineWidth:1.5}}),_=e;d.on("dragging",function(t){var e=d.getId();if(e){var o=parseInt(e.substring(e.lastIndexOf("_")+1)),a=t.dragOffset,r=new maptalks.Coordinate(t.coordinate.x,0),s=i.coordinateToViewPoint(n);if(n.y=0,r.x<n.x){var h=n.substract(r);d.options.dragShadow?d.draggable._shadow.translate(h):d.translate(h),d.draggable._endDrag(t);var l=_.getColumnWidth(o),g=i.viewPointToCoordinate(s.add(new maptalks.Point(l-10,0)));g.y=0,a=n.substract(g)}_._resizeCol(o,a),_._translateTopHandleLine(o,a)}}),d.on("dragstart",function(t){_._removeLeftLines()}),d.on("dragend",function(e){_._createLeftHandleLine(t)}),a.push(d)}(s);return this._adjustLayer.addGeometry(a),a},_translateTopHandleLine:function(t,e){for(var i=t+1;i<this._topLines.length;i++)this._topLines[i].translate(e)},_createLeftHandleLine:function(t){for(var e=this,i=this.getMap(),o=this.getTableWidth(),a=[],r=0,s=0;s<this.getRowsNum();s++)!function(s){var n=i.viewPointToCoordinate(t.add(new maptalks.Point(0,r+10)));r+=e.getRowHeight(s);var h=i.viewPointToCoordinate(t.add(new maptalks.Point(0,r))),l=i.viewPointToCoordinate(t.add(new maptalks.Point(o,r))),d=new maptalks.LineString([h,l],{id:"__table_left_adjust_line_id_"+s,draggable:!0,dragShadow:!1,dragOnAxis:"y",cursor:"ns-resize",symbol:{lineColor:"#ffffff",lineWidth:1.5}}),_=e;d.on("dragging",function(t){var e=d.getId();if(e){var o=parseInt(e.substring(e.lastIndexOf("_")+1)),a=t.dragOffset,r=new maptalks.Coordinate(0,t.coordinate.y),s=i.coordinateToViewPoint(n);if(n.x=0,r.y>n.y){var h=n.substract(r);d.options.dragShadow?d.draggable._shadow.translate(h):d.translate(h),d.draggable._endDrag(t);var l=_.getRowHeight(o),g=i.viewPointToCoordinate(s.add(new maptalks.Point(0,l-10)));g.x=0,a=n.substract(g)}_._resizeRow(o,a),_._translateLeftHandleLine(o,a)}}),d.on("dragstart",function(t){_._removeTopLines()}),d.on("dragend",function(e){_._createTopHandleLine(t)}),a.push(d)}(s);return this._adjustLayer.addGeometry(a),a},_translateLeftHandleLine:function(t,e){for(var i=t+1;i<this._leftLines.length;i++)this._leftLines[i].translate(e)},_bindTableEvent:function(){var t=this.getMap(),e=this;this.on("hide remove dragstart movestart",function(){e._remove()}),this.on("mouseout",function(){t.options.doubleClickZoom=!0}),t.on("movestart zoomstart resize",function(){e._remove()})},_remove:function(){this._adjustLayer.clear()},_removeTopLines:function(){if(this._topLines)for(var t=this._topLines.length,e=t-1;e>=0;e--)this._topLines[e].remove()},_removeLeftLines:function(){if(this._leftLines)for(var t=this._leftLines.length,e=t-1;e>=0;e--)this._leftLines[e].remove()},_resizeRow:function(t,e){var i,o,a,r=this.getMap().coordinateToPoint(e),s=r.y,n=this._rowHeights[t]+s;this.tableHeight+=s,this._rowHeights[t]=n;for(var h=t;h<this._rowNum;h++){i=this._tableRows[h];for(var l=0;l<this._colNum;l++)o=i[l],a=o.getSymbol(),h===t?(o.options.boxMinHeight=n,o.options.boxMinHeight<a.markerHeight&&(a.markerHeight=o.options.boxMinHeight),a.markerDy+=s/2,a.textDy+=s/2):(a.markerDy+=s,a.textDy+=s),o.setSymbol(a)}},_resizeCol:function(t,e){var i=this.getMap().coordinateToPoint(e),o=i.x,a=void 0,r=void 0,s=void 0,n=this._colWidths[t]+o;this.tableWidth+=o,this._colWidths[t]=n;for(var h=0,l=this._tableRows.length;h<l;h++){if(!(a=this._tableRows[h]))return;for(var d=t,_=a.length;d<_;d++)r=a[d],s=r.getSymbol(),d===t?(r.options.boxMinWidth=n,s.markerWidth=r.options.boxMinWidth,s.textWrapWidth=r.options.boxMinWidth,s.markerDx+=o/2,s.textDx+=o/2):(s.markerDx+=o,s.textDx+=o),r.setSymbol(s)}}}),t.Table=h,Object.defineProperty(t,"__esModule",{value:!0})});